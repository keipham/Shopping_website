prompt --application/pages/page_00013beginwwv_flow_api.create_page( p_id=>13,p_user_interface_id=>wwv_flow_api.id(327304041051455600),p_name=>'C_U_D Product details ',p_page_mode=>'MODAL',p_step_title=>'Product details management',p_step_sub_title_type=>'TEXT_WITH_SUBSTITUTIONS',p_first_item=>'NO_FIRST_ITEM',p_autocomplete_on_off=>'OFF',p_javascript_code=>'var htmldb_delete_message=''"DELETE_CONFIRM_MSG"'';',p_page_template_options=>'#DEFAULT#',p_required_role=>wwv_flow_api.id(328224405980893970),p_dialog_chained=>'Y',p_overwrite_navigation_list=>'N',p_page_is_public_y_n=>'N',p_protection_level=>'C',p_cache_mode=>'NOCACHE',p_last_updated_by=>'defaultUser',p_last_upd_yyyymmddhh24miss=>'20000101000000');wwv_flow_api.create_page_plug( p_id=>wwv_flow_api.id(344313854026831050),p_plug_name=>'Form on SOK_PRODUCT_DETAIL_LIST_VW',p_region_template_options=>'#DEFAULT#',p_plug_template=>wwv_flow_api.id(327260456234455539),p_plug_display_sequence=>11,p_include_in_reg_disp_sel_yn=>'N',p_plug_display_point=>'BODY',p_plug_query_row_template=>1,p_plug_query_options=>'DERIVED_REPORT_COLUMNS',p_attribute_01=>'N',p_attribute_02=>'TEXT',p_attribute_03=>'Y');wwv_flow_api.create_page_plug( p_id=>wwv_flow_api.id(344314575881831059),p_plug_name=>'Buttons',p_region_template_options=>'#DEFAULT#',p_plug_template=>wwv_flow_api.id(327260825035455539),p_plug_display_sequence=>10,p_include_in_reg_disp_sel_yn=>'N',p_plug_display_point=>'REGION_POSITION_03',p_plug_query_row_template=>1,p_attribute_01=>'N',p_attribute_02=>'TEXT',p_attribute_03=>'Y');wwv_flow_api.create_page_plug( p_id=>wwv_flow_api.id(351687368439319240),p_plug_name=>'Info',p_region_template_options=>'#DEFAULT#:t-Alert--horizontal:t-Alert--defaultIcons:t-Alert--info',p_plug_template=>wwv_flow_api.id(327258670464455529),p_plug_display_sequence=>10,p_include_in_reg_disp_sel_yn=>'Y',p_plug_display_point=>'BODY',p_plug_source=>'The size range and the sex target of this particular product detail are only editable in the case it has not been ordered yet by a customer.',p_plug_query_options=>'DERIVED_REPORT_COLUMNS',p_plug_display_condition_type=>'EXISTS',p_plug_display_when_condition=>wwv_flow_string.join(wwv_flow_t_varchar2('select product_detail_id ','from sok_order_content_detail_vw','where product_detail_id = :P13_product_detail_id')),p_attribute_01=>'N',p_attribute_02=>'HTML');wwv_flow_api.create_page_button( p_id=>wwv_flow_api.id(344314981958831059),p_button_sequence=>10,p_button_plug_id=>wwv_flow_api.id(344314575881831059),p_button_name=>'CANCEL',p_button_action=>'DEFINED_BY_DA',p_button_template_options=>'#DEFAULT#',p_button_template_id=>wwv_flow_api.id(327293267790455585),p_button_image_alt=>'Cancel',p_button_position=>'REGION_TEMPLATE_CLOSE',p_grid_new_grid=>false);wwv_flow_api.create_page_button( p_id=>wwv_flow_api.id(344314401613831059),p_button_sequence=>20,p_button_plug_id=>wwv_flow_api.id(344314575881831059),p_button_name=>'DELETE',p_button_action=>'REDIRECT_URL',p_button_template_options=>'#DEFAULT#',p_button_template_id=>wwv_flow_api.id(327293267790455585),p_button_image_alt=>'Delete',p_button_position=>'REGION_TEMPLATE_DELETE',p_button_redirect_url=>'javascript:apex.confirm(htmldb_delete_message,''DELETE'');',p_button_execute_validations=>'N',p_button_condition=>'P13_PRODUCT_DETAIL_ID',p_button_condition_type=>'ITEM_IS_NOT_NULL',p_grid_new_grid=>false,p_database_action=>'DELETE');wwv_flow_api.create_page_button( p_id=>wwv_flow_api.id(344314320404831059),p_button_sequence=>30,p_button_plug_id=>wwv_flow_api.id(344314575881831059),p_button_name=>'SAVE',p_button_action=>'SUBMIT',p_button_template_options=>'#DEFAULT#',p_button_template_id=>wwv_flow_api.id(327293267790455585),p_button_is_hot=>'Y',p_button_image_alt=>'Save',p_button_position=>'REGION_TEMPLATE_NEXT',p_button_condition=>'P13_PRODUCT_DETAIL_ID',p_button_condition_type=>'ITEM_IS_NOT_NULL',p_database_action=>'UPDATE');wwv_flow_api.create_page_button( p_id=>wwv_flow_api.id(344314268528831059),p_button_sequence=>40,p_button_plug_id=>wwv_flow_api.id(344314575881831059),p_button_name=>'CREATE',p_button_action=>'REDIRECT_URL',p_button_template_options=>'#DEFAULT#',p_button_template_id=>wwv_flow_api.id(327293267790455585),p_button_is_hot=>'Y',p_button_image_alt=>'Create',p_button_position=>'REGION_TEMPLATE_NEXT',p_button_redirect_url=>'javascript:apex.confirm(''If the given parameters already exist for the given product, the quantities will be added up. Do you wish to continue?'',''CREATE'');',p_button_condition=>'P13_PRODUCT_DETAIL_ID',p_button_condition_type=>'ITEM_IS_NULL',p_security_scheme=>wwv_flow_api.id(328224405980893970));wwv_flow_api.create_page_item( p_id=>wwv_flow_api.id(343984613932405426),p_name=>'P13_PRODUCT_ID',p_item_sequence=>20,p_item_plug_id=>wwv_flow_api.id(344313854026831050),p_use_cache_before_default=>'NO',p_source=>'PRODUCT_ID',p_source_type=>'DB_COLUMN',p_display_as=>'NATIVE_HIDDEN',p_protection_level=>'S',p_attribute_01=>'Y');wwv_flow_api.create_page_item( p_id=>wwv_flow_api.id(344317348091831084),p_name=>'P13_PRODUCT_DETAIL_ID',p_item_sequence=>10,p_item_plug_id=>wwv_flow_api.id(344313854026831050),p_use_cache_before_default=>'NO',p_source=>'PRODUCT_DETAIL_ID',p_source_type=>'DB_COLUMN',p_display_as=>'NATIVE_HIDDEN',p_protection_level=>'S',p_attribute_01=>'Y');wwv_flow_api.create_page_item( p_id=>wwv_flow_api.id(344317700714831129),p_name=>'P13_SIZE_RANGE_CODE',p_is_required=>true,p_item_sequence=>30,p_item_plug_id=>wwv_flow_api.id(344313854026831050),p_prompt=>'Size Range',p_display_as=>'NATIVE_SELECT_LIST',p_named_lov=>'SIZE_RANGE_LOV',p_lov=>wwv_flow_string.join(wwv_flow_t_varchar2('select size_lower_value||''-''||size_higher_value d, size_range_code as r','  from SOK_SIZE_RANGE_LU','  where size_lower_value > 0 and size_higher_value > 0',' order by 1;')),p_cHeight=>1,p_display_when=>wwv_flow_string.join(wwv_flow_t_varchar2('select product_detail_id ','from sok_order_content_detail_vw','where product_detail_id = :P13_product_detail_id')),p_display_when_type=>'NOT_EXISTS',p_field_template=>wwv_flow_api.id(327292952744455582),p_item_template_options=>'#DEFAULT#',p_lov_display_extra=>'YES',p_attribute_01=>'NONE',p_attribute_02=>'N');wwv_flow_api.create_page_item( p_id=>wwv_flow_api.id(344318066859831137),p_name=>'P13_SEX_CODE',p_is_required=>true,p_item_sequence=>50,p_item_plug_id=>wwv_flow_api.id(344313854026831050),p_use_cache_before_default=>'NO',p_prompt=>'Sex',p_source=>'SEX_CODE',p_source_type=>'DB_COLUMN',p_display_as=>'NATIVE_SELECT_LIST',p_named_lov=>'SEX_LOV',p_lov=>wwv_flow_string.join(wwv_flow_t_varchar2('select sex_name,','       sex_code','  from SOK_SEX_TYPE_LU','  where sex_code <> ''UNDEFINED''',' order by 1;')),p_cHeight=>1,p_display_when=>wwv_flow_string.join(wwv_flow_t_varchar2('select product_detail_id ','from sok_order_content_detail_vw','where product_detail_id = :P13_product_detail_id')),p_display_when_type=>'NOT_EXISTS',p_field_template=>wwv_flow_api.id(327292952744455582),p_item_template_options=>'#DEFAULT#',p_lov_display_extra=>'YES',p_attribute_01=>'NONE',p_attribute_02=>'N');wwv_flow_api.create_page_item( p_id=>wwv_flow_api.id(344318471256831137),p_name=>'P13_PRODUCT_DETAIL_STOCK',p_is_required=>true,p_item_sequence=>60,p_item_plug_id=>wwv_flow_api.id(344313854026831050),p_use_cache_before_default=>'NO',p_prompt=>'Stock',p_source=>'PRODUCT_DETAIL_STOCK',p_source_type=>'DB_COLUMN',p_display_as=>'NATIVE_NUMBER_FIELD',p_cSize=>32,p_cMaxlength=>255,p_field_template=>wwv_flow_api.id(327292952744455582),p_item_template_options=>'#DEFAULT#',p_attribute_03=>'right');wwv_flow_api.create_page_validation( p_id=>wwv_flow_api.id(345158154031925450),p_validation_name=>'Check sex target is not undefined',p_validation_sequence=>10,p_validation=>wwv_flow_string.join(wwv_flow_t_varchar2('declare','begin','if :P13_SEX_CODE != ''UNDEFINED'' then','  return true;','else ','  return false;','end if;','end;')),p_validation_type=>'FUNC_BODY_RETURNING_BOOLEAN',p_error_message=>'The sex target cannot remain "Undefined". Please update.',p_always_execute=>'N',p_when_button_pressed=>wwv_flow_api.id(344314320404831059),p_error_display_location=>'INLINE_WITH_FIELD_AND_NOTIFICATION');wwv_flow_api.create_page_validation( p_id=>wwv_flow_api.id(351687478466319241),p_validation_name=>'Check if product detail has already been ordered',p_validation_sequence=>20,p_validation=>wwv_flow_string.join(wwv_flow_t_varchar2('begin','  if sok_product_detail_util.prod_detail_was_ordered(val_product_detail_id => :P13_product_detail_id) = true then','      return false;','  elsif sok_product_detail_util.prod_detail_was_ordered(val_product_detail_id => :P13_product_detail_id) = false then','      return true;','  end if;','end;')),p_validation_type=>'FUNC_BODY_RETURNING_BOOLEAN',p_error_message=>'This product detail cannot be deleted as it has been ordered by a client.',p_always_execute=>'N',p_when_button_pressed=>wwv_flow_api.id(344314401613831059),p_error_display_location=>'INLINE_IN_NOTIFICATION',p_security_scheme=>wwv_flow_api.id(328224405980893970));wwv_flow_api.create_page_da_event( p_id=>wwv_flow_api.id(344315043515831059),p_name=>'Cancel Dialog',p_event_sequence=>10,p_triggering_element_type=>'BUTTON',p_triggering_button_id=>wwv_flow_api.id(344314981958831059),p_bind_type=>'bind',p_bind_event_type=>'click');wwv_flow_api.create_page_da_action( p_id=>wwv_flow_api.id(344315889720831073),p_event_id=>wwv_flow_api.id(344315043515831059),p_event_result=>'TRUE',p_action_sequence=>10,p_execute_on_page_init=>'N',p_action=>'NATIVE_DIALOG_CANCEL',p_stop_execution_on_error=>'Y');wwv_flow_api.create_page_process( p_id=>wwv_flow_api.id(344319511586831146),p_process_sequence=>10,p_process_point=>'AFTER_HEADER',p_process_type=>'NATIVE_FORM_FETCH',p_process_name=>'Fetch Row from SOK_PRODUCT_DETAIL_LIST_VW',p_attribute_02=>'SOK_PRODUCT_DETAIL_LIST_VW',p_attribute_03=>'P13_PRODUCT_DETAIL_ID',p_attribute_04=>'PRODUCT_DETAIL_ID',p_error_display_location=>'INLINE_IN_NOTIFICATION');wwv_flow_api.create_page_process( p_id=>wwv_flow_api.id(344319965651831150),p_process_sequence=>30,p_process_point=>'AFTER_SUBMIT',p_process_type=>'NATIVE_PLSQL',p_process_name=>'Process create product details',p_process_sql_clob=>wwv_flow_string.join(wwv_flow_t_varchar2('begin','    --If parameters (sex, size) already exist for the given product, the product_detail_id will be updated and the quantities will be added up.','    logger.log(''je passe dans create'');','    SOK_PRODUCT_DETAIL_UTIL.c_product_detail(','         val_size_range_code => :P13_SIZE_RANGE_CODE,','         val_sex_code => :P13_sex_code,','         val_product_id => :P13_product_id,','         val_product_detail_stock => :P13_product_detail_stock);','end;','')),p_error_display_location=>'INLINE_IN_NOTIFICATION',p_process_when_button_id=>wwv_flow_api.id(344314268528831059),p_security_scheme=>wwv_flow_api.id(328224405980893970));wwv_flow_api.create_page_process( p_id=>wwv_flow_api.id(343984465196405424),p_process_sequence=>40,p_process_point=>'AFTER_SUBMIT',p_process_type=>'NATIVE_PLSQL',p_process_name=>'Process update product details',p_process_sql_clob=>wwv_flow_string.join(wwv_flow_t_varchar2('begin','    SOK_PRODUCT_DETAIL_UTIL.u_product_detail(','        val_product_detail_id => :P13_PRODUCT_DETAIL_ID,','        val_size_range_code => :P13_SIZE_RANGE_CODE,','        val_sex_code => :P13_SEX_CODE,','        val_product_detail_stock => :P13_PRODUCT_DETAIL_STOCK);','end;')),p_error_display_location=>'INLINE_IN_NOTIFICATION',p_process_when_button_id=>wwv_flow_api.id(344314320404831059));wwv_flow_api.create_page_process( p_id=>wwv_flow_api.id(343984556918405425),p_process_sequence=>50,p_process_point=>'AFTER_SUBMIT',p_process_type=>'NATIVE_PLSQL',p_process_name=>'Process delete product details',p_process_sql_clob=>wwv_flow_string.join(wwv_flow_t_varchar2('begin','','  --I delete selected product details from SOK_PRODUCT_DETAILS_LU and check that the selected product_detail_id is not the last product_detail_id remaining for the associated product','  SOK_PRODUCT_DETAIL_UTIL.d_one_product_detail(','      val_product_detail_id => :P13_PRODUCT_DETAIL_ID);','    ','end;','')),p_process_error_message=>'Product could not be deleted.',p_error_display_location=>'INLINE_IN_NOTIFICATION',p_process_when_button_id=>wwv_flow_api.id(344314401613831059));wwv_flow_api.create_page_process( p_id=>wwv_flow_api.id(344320320929831150),p_process_sequence=>60,p_process_point=>'AFTER_SUBMIT',p_process_type=>'NATIVE_SESSION_STATE',p_process_name=>'reset page',p_attribute_01=>'CLEAR_CACHE_CURRENT_PAGE',p_error_display_location=>'INLINE_IN_NOTIFICATION',p_process_when_button_id=>wwv_flow_api.id(344314401613831059));wwv_flow_api.create_page_process( p_id=>wwv_flow_api.id(344320761660831150),p_process_sequence=>70,p_process_point=>'AFTER_SUBMIT',p_process_type=>'NATIVE_CLOSE_WINDOW',p_process_name=>'Close Dialog',p_error_display_location=>'INLINE_IN_NOTIFICATION',p_process_when=>'CREATE,SAVE,DELETE',p_process_when_type=>'REQUEST_IN_CONDITION',p_process_success_message=>'Action processed.');end;/